!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.CKEditor5=t():(e.CKEditor5=e.CKEditor5||{},e.CKEditor5.embeddedContent=t())}(self,(()=>(()=>{var e={"ckeditor5/src/core.js":(e,t,n)=>{e.exports=n("dll-reference CKEditor5.dll")("./src/core.js")},"ckeditor5/src/engine.js":(e,t,n)=>{e.exports=n("dll-reference CKEditor5.dll")("./src/engine.js")},"ckeditor5/src/ui.js":(e,t,n)=>{e.exports=n("dll-reference CKEditor5.dll")("./src/ui.js")},"ckeditor5/src/widget.js":(e,t,n)=>{e.exports=n("dll-reference CKEditor5.dll")("./src/widget.js")},"dll-reference CKEditor5.dll":e=>{"use strict";e.exports=CKEditor5.dll}},t={};function n(d){var o=t[d];if(void 0!==o)return o.exports;var i=t[d]={exports:{}};return e[d](i,i.exports,n),i.exports}n.d=(e,t)=>{for(var d in t)n.o(t,d)&&!n.o(e,d)&&Object.defineProperty(e,d,{enumerable:!0,get:t[d]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var d={};return(()=>{"use strict";n.d(d,{default:()=>m});var e=n("ckeditor5/src/core.js"),t=n("ckeditor5/src/widget.js");class o extends e.Command{execute(e){const t=this.editor.plugins.get("embeddedContentEditing"),n=Object.entries(t.attrs).reduce(((e,[t,n])=>(e[n]=t,e)),{}),d=Object.keys(e).reduce(((t,d)=>(n[d]&&(t[n[d]]=e[d]),t)),{});this.editor.model.change((e=>{this.editor.model.insertContent(function(e,t){return e.createElement("embeddedContent",t)}(e,d))}))}refresh(){const e=this.editor.model,t=e.document.selection,n=e.schema.findAllowedParent(t.getFirstPosition(),"embeddedContent");this.isEnabled=null!==n}}class i extends e.Plugin{static get requires(){return[t.Widget]}init(){this.attrs={embeddedContentPluginConfig:"data-plugin-config",embeddedContentPluginId:"data-plugin-id"};const e=this.editor.config.get("embeddedContent");if(!e)return;const{previewURL:t,themeError:n}=e;this.previewUrl=t,this.themeError=n||`\n      <p>${Drupal.t("An error occurred while trying to preview the embedded content. Please save your work and reload this page.")}<p>\n    `,this._defineSchema(),this._defineConverters(),this.editor.commands.add("embeddedContent",new o(this.editor))}async _fetchPreview(e){const t={plugin_id:e.getAttribute("embeddedContentPluginId"),plugin_config:e.getAttribute("embeddedContentPluginConfig")},n=await fetch(`${this.previewUrl}?${new URLSearchParams(t)}`);return n.ok?await n.text():this.themeError}_defineSchema(){this.editor.model.schema.register("embeddedContent",{allowWhere:"$block",isObject:!0,isContent:!0,isBlock:!0,allowAttributes:Object.keys(this.attrs)}),this.editor.editing.view.domConverter.blockElements.push("embedded-content")}_defineConverters(){const e=this.editor.conversion;e.for("upcast").elementToElement({view:{name:"embedded-content"},model:"embeddedContent"}),e.for("dataDowncast").elementToElement({model:"embeddedContent",view:{name:"embedded-content"}}),e.for("editingDowncast").elementToElement({model:"embeddedContent",view:(e,{writer:n})=>{const d=n.createContainerElement("figure");return(0,t.toWidget)(d,n,{label:Drupal.t("Embedded content")})}}).add((e=>(e.on("attribute:embeddedContentPluginId:embeddedContent",((e,t,n)=>{const d=n.writer,o=t.item,i=n.mapper.toViewElement(t.item),r=d.createRawElement("div",{"data-embedded-content-preview":"loading",class:"embedded-content-preview"});d.insert(d.createPositionAt(i,0),r),this._fetchPreview(o).then((e=>{r&&this.editor.editing.view.change((t=>{const n=t.createRawElement("div",{class:"embedded-content-preview","data-embedded-content-preview":"ready"},(t=>{t.innerHTML=e}));t.insert(t.createPositionBefore(r),n),t.remove(r)}))}))})),e))),Object.keys(this.attrs).forEach((t=>{const n={model:{key:t,name:"embeddedContent"},view:{name:"embedded-content",key:this.attrs[t]}};e.for("dataDowncast").attributeToAttribute(n),e.for("upcast").attributeToAttribute(n)}))}static get pluginName(){return"embeddedContentEditing"}}var r=n("ckeditor5/src/ui.js");var s=n("ckeditor5/src/engine.js");class c extends s.DomEventObserver{constructor(e){super(e),this.domEventType="dblclick"}onDomEvent(e){this.fire(e.type,e)}}class a extends e.Plugin{init(){const e=this.editor,t=this.editor.config.get("embeddedContent");if(!t)return;const{dialogURL:n,openDialog:d,dialogSettings:o={}}=t;if(!n||"function"!=typeof d)return;e.ui.componentFactory.add("embeddedContent",(t=>{const i=e.commands.get("embeddedContent"),s=new r.ButtonView(t);return s.set({label:Drupal.t("Embedded content"),icon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">\x3c!--! Font Awesome Pro 6.1.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --\x3e<path d="M500.3 7.251C507.7 13.33 512 22.41 512 31.1V175.1C512 202.5 483.3 223.1 447.1 223.1C412.7 223.1 383.1 202.5 383.1 175.1C383.1 149.5 412.7 127.1 447.1 127.1V71.03L351.1 90.23V207.1C351.1 234.5 323.3 255.1 287.1 255.1C252.7 255.1 223.1 234.5 223.1 207.1C223.1 181.5 252.7 159.1 287.1 159.1V63.1C287.1 48.74 298.8 35.61 313.7 32.62L473.7 .6198C483.1-1.261 492.9 1.173 500.3 7.251H500.3zM74.66 303.1L86.5 286.2C92.43 277.3 102.4 271.1 113.1 271.1H174.9C185.6 271.1 195.6 277.3 201.5 286.2L213.3 303.1H239.1C266.5 303.1 287.1 325.5 287.1 351.1V463.1C287.1 490.5 266.5 511.1 239.1 511.1H47.1C21.49 511.1-.0019 490.5-.0019 463.1V351.1C-.0019 325.5 21.49 303.1 47.1 303.1H74.66zM143.1 359.1C117.5 359.1 95.1 381.5 95.1 407.1C95.1 434.5 117.5 455.1 143.1 455.1C170.5 455.1 191.1 434.5 191.1 407.1C191.1 381.5 170.5 359.1 143.1 359.1zM440.3 367.1H496C502.7 367.1 508.6 372.1 510.1 378.4C513.3 384.6 511.6 391.7 506.5 396L378.5 508C372.9 512.1 364.6 513.3 358.6 508.9C352.6 504.6 350.3 496.6 353.3 489.7L391.7 399.1H336C329.3 399.1 323.4 395.9 321 389.6C318.7 383.4 320.4 376.3 325.5 371.1L453.5 259.1C459.1 255 467.4 254.7 473.4 259.1C479.4 263.4 481.6 271.4 478.7 278.3L440.3 367.1zM116.7 219.1L19.85 119.2C-8.112 90.26-6.614 42.31 24.85 15.34C51.82-8.137 93.26-3.642 118.2 21.83L128.2 32.32L137.7 21.83C162.7-3.642 203.6-8.137 231.6 15.34C262.6 42.31 264.1 90.26 236.1 119.2L139.7 219.1C133.2 225.6 122.7 225.6 116.7 219.1H116.7z"/></svg>\n',tooltip:!0}),s.bind("isOn","isEnabled").to(i,"value","isEnabled"),this.listenTo(s,"execute",(()=>{const t=e.model.document.selection.getSelectedElement(),i=new URL(n,document.baseURI);t&&void 0!==t.name&&"embeddedContent"===t.name&&(i.searchParams.append("plugin_id",t.getAttribute("embeddedContentPluginId")),i.searchParams.append("plugin_config",t.getAttribute("embeddedContentPluginConfig"))),d(i.toString(),(({attributes:t})=>{e.execute("embeddedContent",t)}),o)})),s}));const i=e.editing.view,s=i.document;i.addObserver(c),e.listenTo(s,"dblclick",((t,i)=>{const r=e.editing.mapper.toModelElement(i.target);if(r&&void 0!==r.name&&"embeddedContent"===r.name){const t={plugin_id:r.getAttribute("embeddedContentPluginId"),plugin_config:r.getAttribute("embeddedContentPluginConfig")};d(`${n}?${new URLSearchParams(t)}`,(({attributes:t})=>{e.execute("embeddedContent",t)}),o)}}))}}class l extends e.Plugin{static get requires(){return[i,a]}static get pluginName(){return"embeddedContent"}}const m={EmbeddedContent:l}})(),d=d.default})()));
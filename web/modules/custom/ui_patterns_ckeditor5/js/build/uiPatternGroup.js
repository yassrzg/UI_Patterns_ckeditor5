!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.CKEditor5=e():(t.CKEditor5=t.CKEditor5||{},t.CKEditor5.uiPatternGroup=e())}(self,(()=>(()=>{var t={"ckeditor5/src/core.js":(t,e,o)=>{t.exports=o("dll-reference CKEditor5.dll")("./src/core.js")},"ckeditor5/src/ui.js":(t,e,o)=>{t.exports=o("dll-reference CKEditor5.dll")("./src/ui.js")},"ckeditor5/src/utils.js":(t,e,o)=>{t.exports=o("dll-reference CKEditor5.dll")("./src/utils.js")},"dll-reference CKEditor5.dll":t=>{"use strict";t.exports=CKEditor5.dll}},e={};function o(r){var n=e[r];if(void 0!==n)return n.exports;var s=e[r]={exports:{}};return t[r](s,s.exports,o),s.exports}o.d=(t,e)=>{for(var r in e)o.o(e,r)&&!o.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},o.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var r={};return(()=>{"use strict";o.d(r,{default:()=>u});var t=o("ckeditor5/src/core.js"),e=o("ckeditor5/src/utils.js");class n extends t.Command{constructor(t,e,o){super(t),this.set("value",[]),this.set("enabledPatterns",[]),this._styleDefinitions=e,this._patternDefinitions=o}refresh(){const t=this.editor.model,o=t.document.selection,r=this.editor.plugins.get("GeneralHtmlSupport"),n=this.editor.plugins.get("DataSchema"),i=new Set,a=new Set,c=new Set,d=(0,e.first)(o.getSelectedBlocks());if(d){const e=d.getAncestors({includeSelf:!0,parentFirst:!0});for(const o of e){if(t.schema.isLimit(o))break;const e=n.getDefinitionsForModel(o.name).find((t=>t.model==o.name&&1==t.isBlock));if(void 0===e)continue;const a=r.getGhsAttributeNameForElement(e.view);if(t.schema.checkAttribute(o,a))for(const t of this._patternDefinitions){c.add(t.name);o.getAttribute(a);s(o.getAttribute(a),t.classes)&&i.add(t.name)}}}this.enabledPatterns=Array.from(a).sort(),this.isEnabled=this.enabledPatterns.length>0,this.value=this.isEnabled?Array.from(i).sort():[]}execute({patternName:t}){const e=this.editor.model,o=e.document.selection,r=this.editor.plugins.get("GeneralHtmlSupport"),n=this.editor.plugins.get("DataSchema"),s=this._styleDefinitions.find((({name:e})=>e==t)),i=!this.value.includes(s.name);e.change((()=>{let s;s=function(t,e){const o=new Set;for(const r of t){const t=r.getAncestors({includeSelf:!0,parentFirst:!0});for(const r of t){if(e.isLimit(r))break;o.add(r)}}return o}(o.getSelectedBlocks(),e.schema);for(const e of s){const o=n.getDefinitionsForModel(e.name).find((t=>t.model==e.name&&1==t.isBlock));if(void 0!==o)if(i){const n=o.template,s=o.css,i=o.js;e.setAttribute("pattern",{name:t,template:n,css:s,js:i}),r.setAttribute("pattern",{name:t,template:n,css:s,js:i})}else e.removeAttribute("pattern")}}))}}function s(t,e){return!(!t||!t.classes)&&e.every((e=>t.classes.includes(e)))}class i extends t.Plugin{static get pluginName(){return"UiPatternsGroupEditing"}static get requires(){return["GeneralHtmlSupport","DataSchema"]}init(){const t=this.editor,e=function(t=[]){const e=[];for(const o of t)o.options.forEach((t=>{const r=t.name;t.name=`${o.id}:${r}`,e.push({...t})}));return e}(t.config.get("uiPatternsGroup.options"));t.commands.add("uiPatternsGroup",new n(t,e)),this._defineSchema()}_defineSchema(){const t=this.editor.model.schema,e=this.editor.plugins.get("GeneralHtmlSupport"),o=this.editor.plugins.get("DataSchema");for(const r in t.getDefinitions()){const n=o.getDefinitionsForModel(r).find((t=>t.model==r&&1==t.isBlock));if(void 0===n)continue;const s=e.getGhsAttributeNameForElement(n.view);t.setAttributeProperties(s,{isFormatting:!0})}t.setAttributeProperties("htmlAttributes",{isFormatting:!0})}}var a=o("ckeditor5/src/ui.js");class c extends t.Plugin{static get pluginName(){return"UiPatternsGroupUI"}init(){const t=this.editor,e=t.ui.componentFactory,o=Drupal.t,r=t.config.get("uiPatternsGroup.options");r.forEach((t=>{this._addButton(t)})),e.add("UiPatternsGroup",(n=>{const s=(0,a.createDropdown)(n),i=t.commands.get("uiPatternsGroup");s.bind("isEnabled").to(i);const c=[];return r.forEach((t=>{c.push(e.create(`UiPatternsGroup:${t.id}`))})),(0,a.addToolbarToDropdown)(s,c,{enableActiveItemFocusOnDropdownOpen:!1,isVertical:!0,ariaLabel:o("UI Patterns group toolbar")}),s.buttonView.set({label:o("Patterns (group)"),withText:!0,tooltip:!0}),s.bind("class").to(i,"value",(t=>{const e=["ck-ui-patterns-group-dropdown"];return t.length>0&&e.push("ck-ui-patterns-group-dropdown-active"),e.join(" ")})),this.listenTo(s,"execute",(e=>{t.execute(e.source.commandName,{patternName:e.source.commandParam}),t.editing.view.focus()})),s}))}_addButton(t){const o=this.editor;o.ui.componentFactory.add(`UiPatternsGroup:${t.id}`,(r=>{const n=new e.Collection,s=o.commands.get("uiPatternsGroup");t.options.forEach((e=>{const o=`${t.id}:${e.name}`,r={type:"button",model:new a.Model({commandName:"uiPatternsGroup",commandParam:o,label:e.name,withText:!0})};r.model.bind("isOn").to(s,"value",(t=>!!t.includes(o))),n.add(r)}));const i=(0,a.createDropdown)(r);return(0,a.addListToDropdown)(i,n),i.buttonView.set({label:t.label,withText:!0}),i.bind("class").to(s,"value",(e=>{const o=["ck-ui-patterns-group-dropdown-pattern-dropdown"];return e.find((e=>e.includes(`${t.id}`)))&&o.push("ck-ui-patterns-group-dropdown-pattern-dropdown-active"),o.join(" ")})),i}))}}class d extends t.Plugin{static get pluginName(){return"UiPatternsGroup"}static get requires(){return[i,c]}}const u={UiPatternsGroup:d}})(),r=r.default})()));